let INSTANCE_COUNT = 1;
let HIST_LEN = 0;

/**
 * @license
 *
 * shelly-porssisahko
 * shelly-porssisahko-en
 *
 * (c) Jussi isotalo - http://jisotalo.fi
 * https://github.com/jisotalo/shelly-porssisahko
 * https://github.com/jisotalo/shelly-porssisahko-en
 *
 * License: GNU Affero General Public License v3.0
 */
const CNST={INST_COUNT:"undefined"==typeof INSTANCE_COUNT?3:INSTANCE_COUNT,HIST_LEN:"undefined"==typeof HIST_LEN?24:HIST_LEN,ERR_LIMIT:3,ERR_DELAY:120,DEF_INST_ST:{chkTs:0,st:0,str:"",cmd:-1,configOK:0,fCmdTs:0,fCmd:0},DEF_CFG:{COM:{g:"fi",vat:25.5,day:0,night:0,names:[]},INST:{en:0,mode:0,m0:{c:0},m1:{l:0},m2:{p:24,c:0,l:-999,s:0,m:999,ps:0,pe:23,ps2:0,pe2:23,c2:0},b:0,e:0,o:[0],f:0,fc:0,i:0,m:60,oc:0}}};let _={s:{v:"3.4.0",dn:"",configOK:0,timeOK:0,errCnt:0,errTs:0,upTs:0,tz:"+02:00",tzh:0,enCnt:0,p:[{ts:0,now:0,low:0,high:0,avg:0},{ts:0,now:0,low:0,high:0,avg:0}]},si:[CNST.DEF_INST_ST],p:[[],[]],h:[],c:{c:CNST.DEF_CFG.COM,i:[CNST.DEF_CFG.INST]}},_i=0,_j=0,_k=0,_inc=0,_cnt=0,_start=0,_end=0,cmd=[],prevEpoch=0,loopRunning=!1;function getKvsKey(e){let t="porssi";return t=0<=e?t+"-"+(e+1):t}function isCurrentHour(e,t){t-=e;return 0<=t&&t<3600}function limit(e,t,s){return Math.min(s,Math.max(e,t))}function epoch(e){return Math.floor((e?e.getTime():Date.now())/1e3)}function getDate(e){return e.getDate()}function updateTz(e){let t=e.toString(),s=0;"+0000"==(t=t.substring(3+t.indexOf("GMT")))?(t="Z",s=0):(s=+t.substring(0,3),t=t.substring(0,3)+":"+t.substring(3)),t!=_.s.tz&&(_.s.p[0].ts=0),_.s.tz=t,_.s.tzh=s}function log(e){console.log("shelly-porssisahko: "+e)}function reqLogic(){for(let e=0;e<CNST.INST_COUNT;e++)_.si[e].chkTs=0}function updateState(){var e=new Date,t=(_.s.timeOK=null!=Shelly.getComponentStatus("sys").unixtime&&2e3<e.getFullYear(),_.s.dn=Shelly.getComponentConfig("sys").device.name,epoch(e));for(_.s.timeOK&&300<Math.abs(t-prevEpoch)&&(log("Time changed 5 min+ -> refresh"),_.s.p[0].ts=0,_.s.p[0].now=0,_.s.p[1].ts=0,_.p[0]=[],_.p[1]=[]),prevEpoch=t,_.s.enCnt=0,_i=0;_i<CNST.INST_COUNT;_i++)_.c.i[_i].en&&_.s.enCnt++;!_.s.upTs&&_.s.timeOK&&(_.s.upTs=epoch(e))}function getConfig(a){var e=getKvsKey(a);Shelly.call("KVS.Get",{key:e},function(t,e,s){a<0?_.c.c=t?JSON.parse(t.value):{}:_.c.i[a]=t?JSON.parse(t.value):{},"function"==typeof USER_CONFIG&&USER_CONFIG(a,!0);{t=a;var n=function(e){a<0?_.s.configOK=e?1:0:(log("config for #"+(a+1)+" read, enabled: "+_.c.i[a].en),_.si[a].configOK=e?1:0,_.si[a].chkTs=0),loopRunning=!1,Timer.set(500,!1,loop)};let e=0;if(CNST.DEF_CFG.COM||CNST.DEF_CFG.INST){var o,i=t<0?CNST.DEF_CFG.COM:CNST.DEF_CFG.INST,r=t<0?_.c.c:_.c.i[t];for(o in i)if(void 0===r[o])r[o]=i[o],e++;else if("object"==typeof i[o])for(var c in i[o])void 0===r[o][c]&&(r[o][c]=i[o][c],e++);t>=CNST.INST_COUNT-1&&(CNST.DEF_CFG.COM=null,CNST.DEF_CFG.INST=null),0<e?(t=getKvsKey(t),Shelly.call("KVS.Set",{key:t,value:JSON.stringify(r)},function(e,t,s,n){t&&log("failed to set config: "+t+" - "+s),n(0==t)},n)):n(!0)}else n(!0)}})}function loop(){try{if(!loopRunning)if(loopRunning=!0,updateState(),_.s.configOK)if(pricesNeeded(0))getPrices(0);else if(pricesNeeded(1))getPrices(1);else{for(let e=0;e<CNST.INST_COUNT;e++)if(!_.si[e].configOK)return void getConfig(e);for(let e=0;e<CNST.INST_COUNT;e++)if(function(e){var t=_.si[e],s=_.c.i[e];if(1!=s.en)return void(_.h[e]=[]);var e=new Date,n=new Date(1e3*t.chkTs);return 0==t.chkTs||n.getHours()!=e.getHours()||n.getFullYear()!=e.getFullYear()||0<t.fCmdTs&&t.fCmdTs-epoch(e)<0||0==t.fCmdTs&&s.m<60&&e.getMinutes()>=s.m&&t.cmd+s.i==1}(e))return void Timer.set(500,!1,logic,e);"function"==typeof USER_LOOP?USER_LOOP():loopRunning=!1}else getConfig(-1)}catch(e){log("error at main loop:"+e),loopRunning=!1}}function pricesNeeded(e){var t=new Date;let s=!1;return s=1==e?_.s.timeOK&&0===_.s.p[1].ts&&15<=t.getHours():((e=getDate(new Date(1e3*_.s.p[0].ts))!==getDate(t))&&(_.s.p[1].ts=0,_.p[1]=[]),_.s.timeOK&&(0==_.s.p[0].ts||e)),_.s.errCnt>=CNST.ERR_LIMIT&&epoch(t)-_.s.errTs<CNST.ERR_DELAY?s=!1:_.s.errCnt>=CNST.ERR_LIMIT&&(_.s.errCnt=0),s}function getPrices(g){try{log("fetching prices for day "+g);let p=new Date;updateTz(p);var s=1==g?new Date(864e5+new Date(p.getFullYear(),p.getMonth(),p.getDate()).getTime()):p;let e=s.getFullYear()+"-"+(s.getMonth()<9?"0"+(1+s.getMonth()):1+s.getMonth())+"-"+(getDate(s)<10?"0"+getDate(s):getDate(s))+"T00:00:00"+_.s.tz.replace("+","%2b");var n=e.replace("T00:00:00","T23:59:59");let t={url:"https://dashboard.elering.ee/api/nps/price/csv?fields="+_.c.c.g+"&start="+e+"&end="+n,timeout:5,ssl_ca:"*"};p=null,e=null,Shelly.call("HTTP.GET",t,function(o,e,i){t=null;try{if(0!==e||null==o||200!==o.code||!o.body_b64)throw Error(e+"("+i+") - "+JSON.stringify(o));{o.headers=null,i=o.message=null,_.p[g]=[],_.s.p[g].avg=0,_.s.p[g].high=-999,_.s.p[g].low=999,o.body_b64=atob(o.body_b64),o.body_b64=o.body_b64.substring(1+o.body_b64.indexOf("\n"));let e=0,t=0,s=-1,n=[-1,0];function r(){n[1]=n[1]/t,_.p[g].push(n),_.s.p[g].avg+=n[1],n[1]>_.s.p[g].high&&(_.s.p[g].high=n[1]),n[1]<_.s.p[g].low&&(_.s.p[g].low=n[1])}for(;0<=e;){o.body_b64=o.body_b64.substring(e);var c=[e=0,0];if(0===(e=1+o.body_b64.indexOf('"',e))){0<t&&r();break}c[0]=+o.body_b64.substring(e,o.body_b64.indexOf('"',e)),e=2+o.body_b64.indexOf('"',e),e=2+o.body_b64.indexOf(';"',e),c[1]=+(""+o.body_b64.substring(e,o.body_b64.indexOf('"',e)).replace(",",".")),c[1]=c[1]/10*(100+(0<c[1]?_.c.c.vat:0))/100;var a=new Date(1e3*c[0]).getHours();c[1]+=7<=a&&a<22?_.c.c.day:_.c.c.night,e=o.body_b64.indexOf("\n",e),s<0&&(n[0]=c[0],s=a),(s!=a||e<0)&&(r(),n=[c[0],0],t=0,s=a),n[1]+=c[1],t++}if(o=null,_.s.p[g].avg=0<_.p[g].length?_.s.p[g].avg/_.p[g].length:0,_.s.p[g].ts=epoch(p),_.p[g].length<23)throw Error("invalid data received")}}catch(e){log("getting prices failed, help: https://github.com/jisotalo/shelly-porssisahko/issues/59"),log(e),_.s.errCnt+=1,_.s.errTs=epoch(),_.s.p[g].ts=0,_.p[g]=[]}0==g&&reqLogic(),loopRunning=!1,Timer.set(500,!1,loop)})}catch(e){log("getting prices failed, help: https://github.com/jisotalo/shelly-porssisahko/issues/59"),log(e),_.s.errCnt+=1,_.s.errTs=epoch(),_.s.p[g].ts=0,_.p[g]=[],0==g&&reqLogic(),loopRunning=!1,Timer.set(500,!1,loop)}}function logic(c){try{"function"==typeof USER_CONFIG&&USER_CONFIG(c,!1),cmd[c]=!1;var e,t,s=new Date;updateTz(s),!function(){if(_.s.timeOK&&0!=_.s.p[0].ts){var t=epoch();for(let e=0;e<_.p[0].length;e++)if(isCurrentHour(_.p[0][e][0],t))return _.s.p[0].now=_.p[0][e][1];_.s.timeOK=!1,_.s.p[0].ts=0,_.s.errCnt+=1,_.s.errTs=epoch()}else _.s.p[0].ts,_.s.p[0].now=0}();let i=_.si[c],r=_.c.i[c];function n(e){if(null==e)loopRunning=!1;else if(cmd[c]!=e&&(i.st=12),cmd[c]=e,r.i&&(cmd[c]=!cmd[c]),log("logic for #"+(c+1)+" done, cmd: "+e+" -> output: "+cmd[c]),1==r.oc&&i.cmd==cmd[c])log("outputs already set for #"+(c+1)),i.cmd=cmd[c]?1:0,i.chkTs=epoch(),loopRunning=!1;else{let n=0,o=0;for(let e=0;e<r.o.length;e++)!function(e,o,i){e="{id:"+o+",on:"+(cmd[e]?"true":"false")+"}",Shelly.call("Switch.Set",e,function(e,t,s,n){0!=t&&log("setting output "+o+" failed: "+t+" - "+s),i(0==t)},i)}(c,r.o[e],function(e){if(n++,e&&o++,n==r.o.length){if(o==n){if(i.cmd!=cmd[c]){for(var t=c,s=0<_.s.enCnt?CNST.HIST_LEN/_.s.enCnt:CNST.HIST_LEN;0<CNST.HIST_LEN&&_.h[t].length>=s;)_.h[t].splice(0,1);_.h[t].push([epoch(),cmd[t]?1:0,_.si[t].st])}i.cmd=cmd[c]?1:0,i.chkTs=epoch(),Timer.set(500,!1,loop)}loopRunning=!1}})}}0===r.mode?(cmd[c]=1===r.m0.c,i.st=1):_.s.timeOK&&0<_.s.p[0].ts&&getDate(new Date(1e3*_.s.p[0].ts))===getDate(s)?1===r.mode?(cmd[c]=_.s.p[0].now<=("avg"==r.m1.l?_.s.p[0].avg:r.m1.l),i.st=cmd[c]?2:3):2===r.mode&&(cmd[c]=function(e){var t=_.c.i[e],s=(t.m2.ps=limit(0,t.m2.ps,23),t.m2.pe=limit(t.m2.ps,t.m2.pe,24),t.m2.ps2=limit(0,t.m2.ps2,23),t.m2.pe2=limit(t.m2.ps2,t.m2.pe2,24),t.m2.c=limit(0,t.m2.c,0<t.m2.p?t.m2.p:t.m2.pe-t.m2.ps),t.m2.c2=limit(0,t.m2.c2,t.m2.pe2-t.m2.ps2),[]);for(_inc=t.m2.p<0?1:t.m2.p,_i=0;_i<_.p[0].length;_i+=_inc)if(!((_cnt=-2==t.m2.p&&1<=_i?t.m2.c2:t.m2.c)<=0)){var n=[];for(_start=_i,_end=_i+t.m2.p,t.m2.p<0&&0==_i?(_start=t.m2.ps,_end=t.m2.pe):-2==t.m2.p&&1==_i&&(_start=t.m2.ps2,_end=t.m2.pe2),_j=_start;_j<_end&&!(_j>_.p[0].length-1);_j++)n.push(_j);if(t.m2.s){for(_avg=999,_startIndex=0,_j=0;_j<=n.length-_cnt;_j++){for(_sum=0,_k=_j;_k<_j+_cnt;_k++)_sum+=_.p[0][n[_k]][1];_sum/_cnt<_avg&&(_avg=_sum/_cnt,_startIndex=_j)}for(_j=_startIndex;_j<_startIndex+_cnt;_j++)s.push(n[_j])}else{for(_j=0,_k=1;_k<n.length;_k++){var o=n[_k];for(_j=_k-1;0<=_j&&_.p[0][o][1]<_.p[0][n[_j]][1];_j--)n[_j+1]=n[_j];n[_j+1]=o}for(_j=0;_j<_cnt;_j++)s.push(n[_j])}if(-1==t.m2.p||-2==t.m2.p&&1<=_i)break}let i=epoch(),r=!1;for(let e=0;e<s.length;e++)if(isCurrentHour(_.p[0][s[e]][0],i)){r=!0;break}return r}(c),i.st=cmd[c]?5:4,!cmd[c]&&_.s.p[0].now<=("avg"==r.m2.l?_.s.p[0].avg:r.m2.l)&&(cmd[c]=!0,i.st=6),cmd[c])&&_.s.p[0].now>("avg"==r.m2.m?_.s.p[0].avg:r.m2.m)&&(cmd[c]=!1,i.st=11):_.s.timeOK?(i.st=7,e=1<<s.getHours(),(r.b&e)==e&&(cmd[c]=!0)):(cmd[c]=1===r.e,i.st=8),_.s.timeOK&&0<r.f&&(t=1<<s.getHours(),(r.f&t)==t)&&(cmd[c]=(r.fc&t)==t,i.st=10),cmd[c]&&_.s.timeOK&&s.getMinutes()>=r.m&&(i.st=13,cmd[c]=!1),_.s.timeOK&&0<i.fCmdTs&&(0<i.fCmdTs-epoch(s)?(cmd[c]=1==i.fCmd,i.st=9):i.fCmdTs=0),"function"==typeof USER_OVERRIDE?USER_OVERRIDE(c,cmd[c],n):n(cmd[c])}catch(e){log("error running logic: "+JSON.stringify(e)),loopRunning=!1}}let _avg=999,_startIndex=0,_sum=0;log("v."+_.s.v),log("URL: http://"+(Shelly.getComponentStatus("wifi").sta_ip??"192.168.33.1")+"/script/"+Shelly.getCurrentScriptId()),_.c.i.pop(),_.si.pop();for(let e=0;e<CNST.INST_COUNT;e++)_.si.push(Object.assign({},CNST.DEF_INST_ST)),_.c.i.push(Object.assign({},CNST.DEF_CFG.INST)),_.c.c.names.push("-"),_.h.push([]),cmd.push(!1);CNST.DEF_INST_ST=null,prevEpoch=epoch(),HTTPServer.registerEndpoint("",function(s,n){try{if(loopRunning)return s=null,n.code=503,void n.send();var o=function(e){var t={},s=e.split("&");for(let e=0;e<s.length;e++){var n=s[e].split("=");t[n[0]]=n[1]}return t}(s.query),i=parseInt(o.i);s=null;let e="application/json",t=(n.code=200,!0);var r="text/html",c="text/javascript";if("s"===o.r)updateState(),0<=i&&i<CNST.INST_COUNT&&(n.body=JSON.stringify({s:_.s,si:_.si[i],c:_.c.c,ci:_.c.i[i],p:_.p})),t=!1;else if("c"===o.r)updateState(),0<=i&&i<CNST.INST_COUNT?n.body=JSON.stringify(_.c.i[i]):n.body=JSON.stringify(_.c.c),t=!1;else if("h"===o.r)0<=i&&i<CNST.INST_COUNT&&(n.body=JSON.stringify(_.h[i])),t=!1;else if("r"===o.r){if(0<=i&&i<CNST.INST_COUNT)log("config changed for #"+(i+1)),_.si[i].configOK=!1;else{log("config changed");for(let e=0;e<CNST.INST_COUNT;e++)_.si[e].configOK=!1}_.s.configOK=!1,reqLogic(),loopRunning||(loopRunning=!0,getConfig(i)),_.s.p[0].ts=0,_.s.p[1].ts=0,n.code=204,t=!1}else"f"===o.r&&o.ts?(0<=i&&i<CNST.INST_COUNT&&(_.si[i].fCmdTs=+(""+o.ts),_.si[i].fCmd=+(""+o.c),_.si[i].chkTs=0),n.code=204,t=!1):o.r?"s.js"===o.r?(n.body=atob("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"),e=c):"s.css"===o.r?(n.body=atob("H4sIAAAAAAAACo1WTW/jNhD9K4MNFsh6LVmK16lDoUF7WqBoi17aS9EDRY0s1hRJkONEXsP/vSD1YcVJsL0YJjnD+XjzHrVaLGABvkGljok1znvpebM3ELZvxSf45eC9BOkNcWUggYbIstXq32EnrSUs4qZnq9VOUnMoU2HayWD1zt2/SoHaI4Ovv/8JP9c1OgNfUaPjCv44lEqK0QSe1mkGixUs4ASl6RIvv0m9Y1AaV6FLStMVcIbSVMclcDiBMMo4Bjco6qzOx7PgzMV+58xBVwxu7sQaN1kBSmpMGpS7hhjk6RdsC6iNphAGGWTpw7RT81aqI4O/0FVc8wJa3iXPsqKGwZcHF+yGVZ5lH8Ox20nNIAN+IFOA5VUVM9/YDvLMxrxvSJJCOM2DDmn0/klpiEwbvaKDMPb40j5Lt8GeK7nTiUdVM6gVdgnqqgDCjpJ4xMCFMsMlaa06OEElvVX82JvHfeKlhxNY4yVJE1xQcZJPWLxsX85L8SAmF8ZKrI3D5bjkNaGLYGhCTQw+fCgu4YiXCmfOk7VC7gKy1IynoVJlODFQWPe5k19C2szT10ZP1yWKl6jmp6UyYn+F9F36wyb0bMIkgzy9CzvDWLnBznbgjZIV3OT3PNtuChAH58OAWSM1oZviDqXC6eUUXFrJS2/UgbCAb4nUFXYM8gLI2Es6oUYG2SyvPM7Vi97XdV1MUz7OsbFcSDpG59gjJhoUe6w+v2jK9y/q63/jnnjF56tSp7D5rKq73tXYOQo7J6si/iaErVWcMBFGHVrtGeS1iyQJf6Kzt3rWyPQuduFC0349pRrXA07kuPaWO9Q0gTnWOE7tsE3GjkfPjQzAjODzSh48g00AkGvZ8h7BkFXu4yRxB1LXUke3qUip45QNE3eGn/Z4rB1v0UNfUZgJOPVJ1sa1DJwhTni7vs8q3H2CM5x7eqRCPFJQrkdyj1SxWjpPiWikqpaQlrvlYOZbIDc/HbXheehWaVRVwBM6koKrUQrI2PcpXasuaU3AWUX+YZdU0qEYJME8x9parCS/nYvgNrPdJzi9rVH3AbK5GvWEHlQu0iDZ2m42O98ZltHyEZimpi/+dh3irxbwG99LvQNqENaugt4ZdgbIgMaOIoiLVR+jP2WQwwqS+GT0vW3nCCzhptw/vqcuLzj/pv8VRkPdA+ND3ZepjOyb3rde/rPZta8Rn/vmtoNScbHvGfE/EO3rvzZ8rOTTlOiQwJDCJaIPAhAFdM42xW143Md/r9tzyfmNfOcPZQ+yCJyZjY7ASXprOZfcj0VP5ZgXhpfh2XEbDZ/zbTaz3I6Xt5RnFzz6Dg6Pc+hGPvQrSlwwd5t5U+Jjng1q2arNNbJjlHIJNz4R7Tv0PIPU9kB/09Hij+WByOh/rj8K8kCg84X2pzc+VIbqRnpcJCLEnfq6Dkm93U9/aFvuAnlfv3P/AXPmnH4uCgAA"),e="text/css"):"status"===o.r?(n.body=atob("H4sIAAAAAAAACpWSS26DMBRFt2IxaiMBYVCpA8cLqCp10GzgYTvC4A/FjyTshzV0A2ys4mclbfqbeOB773n3WaYIuZaEa/B+FxnCecQoNoyiYM+gUJISiCtKaD1FQZTY+VjY1bLkTtnjlr1MJmI7DEZuRogABLBJkqzcyVl5aYmXWqEMfo9h9uvQF9XwbkmhLMIV1boTu0J57Lq6VsFgnJDBsVcagqLswTGaTjszKtRxXfygz+Sgz7Fxecydjq5E5KOWEdM8fBEMZtuI0XwtTHDo7dAPvaVpzmgq1JHR+Y2nBrXa3ixwido7lC22Bn6AzTHkC/UCOrtu1dd/qF+0zkhr4bv22T/a/8LKPneeT9/WbLOpoapcvHy8dLyb5k3JY9g+ZHijamSNfHvydxFCHnsEbH1S+uiepov8ARap9CvsAgAA"),e=r):"status.js"===o.r?(n.body=atob("H4sIAAAAAAAACoVX627bOBb+P0/BsBmVrGRGcgezqCXamJ3pIou26GBrYH4ExoaRaJsTifKIJ0oDS//6KHmGfQG/2IK62HLiTNMEPSTP5eO5UttUArrkryMophEkKM5TsxGa47d4+l6hUsl094hAySQ3RkQXkEyjCyimr8M41wbQDSeUT7elKBBw4NO/DAHKlNayuJx/+sgxDoFgM4qzBFPvL7OnmYGHVLI4T/OC41e+72Ov4Uw0pi2l8/uezPJE9vTG31PqQAaHzT2p9DLvaQOY1qHFGXNhHnSMgE+3UDxs1ZJAVZW5SpDPOTcgQNIbcox2cKOPIhEghGaM4VCmRloNZ60YrIv8Hr0virwgWOfIcmIaWievW83eiq+ZaYBIvmaxZ+xaNSyl3VAecFIyqWfkNADD4iyZ4d9333bfPn7cfcMT/Pvnf3/BL3q3E1gVUmo8wYVMet7WrQPdnz7/9v6/X+b/uSqZPVt0fE0kBmx+tGYblkq9gvVsxTZX/oLp/J5B/i/1VSZkTF2M4ovbP9Z4gntjNgIDHe+sr5mB2Zf5L/PWqF0uWCE3qYglwT8a7C3zIhPwmwA5V5kkWt4juyCBfPvGsOWvWTI31DsLKJ080eOSkqkZRuR297h71CCVlppaPNTD+KyxXTgOOQXO5Ti6Kab2D7sNY58NbUoducKweH07NzP8ef2nuDMIRHGrDEiAO4Td9gKnwDdSlE7wvBcQQqO8UQLCZhedkEMePrOM3yt0u3t8gN3/jNk94hfy9bqD9ep8q7QBN6iRVChP5VD4+uXStJVJvRVLdFXhSNmuIIxsrhddqCmmoWRaZNJcWfULxyHgcowqhN2jA+qBy68RyZ/Cob1xW/kD4PDCxa32EcIu8aMu9cDM8KXSWgDa7B5VqSy6h79x/icBa5aJr2SvwLNUYClqQ3KpNOR/CrQWsi/1Pg7lsXc/7B4ftG7j/YDOt3+XsCt2t7Ehr5ukbMTM7hGdbwnZM1K2ki1iOjolfDimF4F8e/Gzb3/HP9F98eEA07p1hM18ikaolIVRObp2V6xsWo+2vXrbNqFD70+FMRwDulnh6QdpbpUoyrzt+U+PL0VaKn367INIU9kftsOikHBXaNtfwUZLupcT6V7/gLofi2C/sMtker4FJsrVoKXUbUdp1J5gTo/6z3eY12q1/h53A/269hTvekQzbgax11369JnRTJ5n58GCekR5xWFMvkYnPf6LuhUvOFtpeOGoLe6hq9WS+GfcWlZNOjdGBb9a2JMx57xt7bSLfsmyMdtE/iyYtGS4zAtipxFwPwTb6K2itteH4PJOMuOjMe+kHSeIOMyaRTxu9cTW3BnJIu7TViKxGKxiycEzHNzOXo/AcWx6zEiPyXimoySdHBnjHBznwDc+MI7pAL4MITKOc0ZgenSLUUBDcF2asM2dWROgFmqjwNBtK/ru3TtPc3+vzHA/NBFPeg1ZaFy3ZZYDNuDG2nSzRr90eWv3KrmCxeIqWITyIossduDyIvM0N7Q+yOoQIt3JihabFaR188h4bisIIUoOkXFbN+fcCjVsksMoCP2IS8fpkOQWRrSHJTtYoxFNrqQbLLjdCzs6r49z4QQ0tSSjoA9NVT3NCXpTSHFb13XnRE/zM1IMm/whYPZy8km+yf5Wm96VcuGl/KgxtiUY20fT0gmiSFLO7X+OY3fi4ZY3P8Hlcz5g9JYci3KFu3tks66SRLlqEzsLW4cQf19LjlOyzGdxVQWDPVv6EScHbQFLn2gLWEqrajwQEkzpOL1LpCGS9jqWxzzPFI+fKR6zdCgdU8c5m4clU03unQH17AuzquwiaBeOM7RBDlVJZB9TU1V7WtLjaA+4xkO2Ma0qP+q55JSbru6p4xDjdmw2LzT1iuGUv46gQM1ThOPzbWoH32V+VxhCOT8el912E0o1w8tcw+heqtUaJjd5moT20Vefb/UM34j4dlXkdzqZvJKJ/dce4uGQaMZE32aXCvC0H+vN4E3tc7N+Oln62dK+Ir43h/aTaIadV1/H/wh+6kHGVTWf4TdvmuWz8dWOpG6a7nt8fVRR7mVNQ0X8fir5mFJPkaBfB5jSuo4FxLb3be13XJ5KJpuPFqDey58+13OVCvt67L8HEbHDNJPGiJU8POROvCLtR0ddhzGh3q///NJ2kJjW/we/7+OPfw4AAA=="),e=c):"history"===o.r?(n.body=atob("H4sIAAAAAAAACmWNOw7CMBBEr2K5gsJY9JuVaGkoOIF/IRuMDN5NlNweEQWElGaK90YzEGlUITvmRrd5Um2ezKN4E0rWCH9SwscdNYI4nxOCVASJP638TeOJ7m4DL13vBt7ga8okCeyy40ucFcWGTUcsCHY9sZHGb3Ko9BSs6XXmnRbnl26p86FnvQe7+jdGEOBV0gAAAA=="),e=r):"history.js"===o.r?(n.body=atob("H4sIAAAAAAAAClWS0WrbMBSGX0U9ZEOaHbdd2E0cOWxrYRctg8a7MmY9cY5jbaqVSSctwfXb9E36YsMOGynoRgfp+38+qbPEwuiiTCvXBhZrzTrr/gQJYdqYwKAS07bkv+W3NxoW7LMFb0TlbNhhq2fZtRHDMecN4uKcN9ninH0GffqIXlQaw6GtxIAc9l6fglP2h87Ukp+f2721WgdGJuWJ974Va6lSU0tgXE+PCQfQGis2j5TjWo1AilHjExoWW+IrZJQ/7m5WESy9bt4bDZFpA48cTNxvNaSdSaMx2SCjSiy1W25OEnuygYSp5aeL2ZnWmFRu86aRP7UBae28JOFqYZLgPEvJsVc688VFOeXiolTHmuFoDuKg5bAifT9atBiChtowZJOudv4BOTcPJFt6ElfIJC9p9oFGTj/KvVfReDPwwZKGylnn55OOistyCVtP1MIcPG2gH4jH8ffmF+6D2L2+vL5YSzD/P3EmwBtuNulW+ef8+ucqvyuo+FiWy8TTzmJFEoR8FwQGNgpigH+FIjg++KmZSIe+7yvkqpGsuuFjOUsJee+8ZBWfSuS+Tyup4q9fVsluHxpZqf4v8DUOEZQCAAA="),e=c):"config"===o.r?(n.body=atob("H4sIAAAAAAAACpVWS27jRhC9SoNBMPaC+tDOjGFQDXDhgWXLUhDJDrIskW2zzO4mh12Uo6xzFJ7BF+DFAv4kkbbszEYCu36vX9Ur0g1wwzCY+I9PtmS+BGMm5PMZBEAAejAYuMMAN9zd+zFDWykmAZpEwvZSx1rU5jraIp+trdrnMdZkG/xHXI4HjlD8r9nVdHm1Yt7yanV/u7xaNckJ1lK08Yr5vsVdSrlLAb8DKP9cI6TwqYTwxN04IYw124DMxOQR+TKLFXZPheAPmMbdQ7nhM6ANQu+Y+AwFUQbusK7Tlm8wvYwvRnxZ5GFUvGrmzR4qSKiTrEK0AWLlLSdnnP3aAl8iphQriExG5fPom+04l2wfFcB2F+UPoz/DAxIVjUfccezRt8MIjU8h9WJqAocVg/02lFmO9mJxfePdL9kvrklAV61F7g7LB/5pVw5puS3yLRWvxhR5xYqEtZAtObRNxMQPhR+t47/LIkJztpgPF9+/u8PGs+Frjgq7tOqdbRE+Q2YIkv4sqDgQvN+0yp0IyrbIIg+D4pW6meOMTM3j+S5oVntqFlfFeoVivzd1I+6hBkaQRmgIhDG9oRrzB0DNVJYRZZX5PZiZUaizjLCHUKHeNVqhbkNui7zINQnUogP0CNuoN7tqD5CqLDOUaV0VK+3raGe+LnIqckIJB2k/6WWaHmvm7xBFsV1lioyo7xYIApSmnXD5G3dNphSkWz6vZigfJogyppKpxtDMIAaTx7CdRKOqwbb2Uz9sUr+rg0YE/Lb4dzmth/6n5nvxf+lQI9tXwRtGPoB0PZ2vvD+8G++nAF2jJkjhGXoTM7Ylqv52OF78xrtdLubs2ps9TO/uvBVb3c/n08838iEU7xn0M0Qm7svSsROR9hTjnHPnPOyJxOFjp3d2wS96J1/5197JOe9nOuNnvROH9zPbYx4rKB9KCtnJmFXgT3teTtfLqb3gdCdgVu/MmoiQA0awKXKJ7CSS8ellu0UpbWfdsf1a8QoYdDjbt8+xE9N273I0YjbrGsWBsZXZKtOEqtwJabN9D0N8vX9ZhF00zls4zHkHkPMhIqcL6U3+Drx38vuanA7CeneItMijqMix3RzHBOfY5sdu5VTrOCmLSVnkzO4ppC7ThElUrUJ2nxmRQYVh2fJjUeoDVTVvW+vgggY2oga9zoh247UCKYXWwA8+rN68svlqMb2bzueL1Rsv8tsa+0+FTplyWcapL5p6B6vYcHedfhIda1+iH02+vKAO4pdBnAh9Yg2t0y91OmsZCim3moUgK4FY7UXqX+OnmBBPxY8bc2IRrG0/1o/4NHg2Vqmg2vwfbuoFencKAAA="),e=r):"config.js"===o.r?(n.body=atob("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"),e=c):n.code=404:(n.body=atob("H4sIAAAAAAAACqVTwW7bMAz9FU0DhgSL7fU2NJKKYS2w9bIdhl4LRWJiNorkiXSCYNjf7Bv6A/2xwXbS1e0KdNiFNvkeH58oW73yyfG+gZo3waguimDjSkM0agNshattJmDd8rJ4bxQjBzBf724zEdLdr3p9d6uqoTo0RLsBvUXYNSmzcCkyRNZyh55r7WGLDoo+mWFERhsKcjaAPpFGedwKFyyR5tQMKXr915kHjBqMhxZqolGVx+0x9oEggOOOipHYqNQwpii2NrSg35kv9Y1tSbw+UdXAfNDcNbnU7M2bLs7FZUuE4jMltiGJibKizrDUNXNDp1V1gwNSLlGwzStgfb0INq7NA0RV1kwfuzye2S7oUW4UxqZl0V2RztZjGvZr+73YRUFsuSXhanBr8PrwPAqQESrYBQSxTHnEPw4oeth8w2BVNbyPHRSHG+yXUfyReLLqfzBdI3HK++ddPiLc2/zU1/HFVg86/+PVpbjE1fNWx/i90w8E3K4J+KVWB52x0yGSy9iwcSkSi/OLK73D6NOuDMnZ7lsuU8YVxhKjC60HmsgOCXUiltN5ABZe++TaDUSeuQyW4SJAl2nQxpej0gSmM9s0EP3HGoMfGIvk9+WDakfK8P2SOvjH1mZBeqwiB9NyOqeSstPnF1dncCrPspZvoczQBOtgIruDy5mUo5kTmv6cOXoiGTCu5XTuiMoMQUvifQCqAVh29LL/GbtBkkpHJPtxw+tI3hEd7E8klTckp6o67Pg3taztjQ8FAAA="),e=r);n.headers=[["Content-Type",e]],t&&n.headers.push(["Content-Encoding","gzip"])}catch(e){log("server error: "+e),n.code=500}n.send()}),Timer.set(1e4,!0,loop),loop();
//end

